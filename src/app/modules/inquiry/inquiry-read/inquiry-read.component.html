<div *ngIf="$inquiry | async as inquiry">
  <div class="row">
    <div class="col-md-12">
      <app-inquiry-info-edit title="Заявление {{inquiry.number}}">
        <div class="row">
          <div class="col-md-6">
            <h4>Заявление в {{inquiry.typeFriendlyName}}</h4>
            <app-inquiry-common-info [inquiry]="inquiry">
              <dt>Заявление на перевод</dt>
              <dd>Нет</dd>
              <div *ngIf="inquiry && inquiry.privilege && inquiry.privilege.privilegeOrder">
                <dt>Льгота</dt>
                <dd>
                  {{inquiry.privilege.privilegeOrder.name}}<br>
                  <i>{{inquiry.privilege.name}}</i>
                </dd>
                <dt>Документ, подтверждающий льготу</dt>
                <dd>{{getDocumentView(inquiry.privilege.privilegeProofDocument)}}</dd>
              </div>
              <dt>Доп. информация</dt>
              <dd>{{inquiry.addInformation}}</dd>
            </app-inquiry-common-info>
          </div>
        </div>
        <div class="button-row" [formGroup]="statusForm">
          <mat-form-field style="width: 70%">
            <mat-select placeholder="Перевести в статус" formControlName="status" #status>
              <mat-option *ngFor="let status of statuses" [value]="status.id">
                {{status.name}}
              </mat-option>
            </mat-select>
          </mat-form-field>
          <button type="button" class="btn btn-primary" (click)="changeStatus(status.value)">Выполнить</button>
        </div>
      </app-inquiry-info-edit>
    </div>
  </div>
  <div class="row" *ngIf="inquiry.applicant">
    <div class="col-md-6">
      <app-inquiry-info-edit title="Доверенное лицо законного представителя ребенка">
        <app-person-card [entity]="inquiry.applicant" [mode]="modes.Edit"></app-person-card>

        <app-citizenships-card [model]="inquiry.applicant"></app-citizenships-card>
        <app-confirmation-document-card title="Документ, подтверждающий право пребывания доверенного лица законного представителя на территории РФ"
          [model]="inquiry.applicant.countryStateApplicantDocument" [mode]="modes.Edit">
        </app-confirmation-document-card>
        <app-confirmation-document-card title="Документ, подтверждающий полномочие доверенного лица представлять интересы законного представителя"
          [model]="inquiry.applicant.applicantRepresentParentDocument" [mode]="modes.Edit">
        </app-confirmation-document-card>
      </app-inquiry-info-edit>
      <!-- <app-adult-card title="Доверенное лицо законного представителя ребенка" [entity]="inquiry.applicant" [edit]="edit.person">
      </app-adult-card> -->
    </div>
    <div class="col-md-6" *ngIf="inquiry.applicantType != applicantTypes.Child">
      <!-- <app-adult-card title="Законный представитель" [entity]="inquiry.parent" [edit]="edit.person">
      </app-adult-card> -->
      <app-inquiry-info-edit title="Законный представитель">
        <app-person-card [entity]="inquiry.parent" [mode]="modes.Edit"></app-person-card>

        <app-citizenships-card [model]="inquiry.parent"></app-citizenships-card>
        <app-confirmation-document-card title="Документ, подтверждающий право пребывания законного представителя на территории РФ"
          [model]="inquiry.parent.countryStateDocument" [mode]="modes.Edit">
        </app-confirmation-document-card>
        <app-confirmation-document-card title="Документ, подтверждающий право законного представителя представлять интересы ребенка"
          [model]="inquiry.parent.parentRepresentChildrenDocument" [mode]="modes.Edit">
        </app-confirmation-document-card>
      </app-inquiry-info-edit>
    </div>
  </div>
  <app-children-card [children]="inquiry.children"></app-children-card>
  <app-school-inquiry-info-card [schoolInquiryInfo]="inquiry.schoolInquiryInfo" [edit]="edit.schoolInquiryInfo" *ngIf="inquiry.schoolInquiryInfo"></app-school-inquiry-info-card>
  <app-preschool-inquiry-info-card [inquiryInfo]="inquiry.inquiryInfo" [edit]="edit.inquiryInfo" *ngIf="inquiry.type == inquiryTypes.preschool"></app-preschool-inquiry-info-card>
  <div class="row">
    <div class="col-md-4">
      <app-contact-info-card [contactInfo]="inquiry.contactInfo" [edit]="edit.contactInfo"></app-contact-info-card>
    </div>
    <div class="col-md-4">
      <app-institutions-card [institutions]="inquiry.institutions" [edit]="edit.institutions" *ngIf="inquiry.type == inquiryTypes.preschool"></app-institutions-card>
      <app-school-classes-card [schoolClasses]="inquiry.schoolClasses" [IsLearnEducCenter]="inquiry.IsLearnEducCenter"
        [edit]="edit.institutions" *ngIf="inquiry.type == inquiryTypes.school"></app-school-classes-card>
    </div>
    <div class="col-md-4">
      <app-current-education-place-card [currentEducationPlace]="inquiry.currentEducationPlace" [edit]="edit.currentEducationPlace"></app-current-education-place-card>
    </div>
  </div>
  <div class="row">
    <div class="col-md-4">
      <app-inquiry-info-edit title="Льготная категория" (edit)="edit.privilege()">
        <ng-container *ngIf="inquiry.privilege">
          <dl class="dl-horizontal">
            <dt>Приоритет льготной категории </dt>
            <dd>{{inquiry.privilege.privilegeOrder.name}}</dd>
            <dt>Льготная категория </dt>
            <dd>{{inquiry.privilege.name}}</dd>
          </dl>
          <app-confirmation-document-card [model]="inquiry.privilege?.privilegeProofDocument" [mode]="modes.Edit" title="Документ, подтверждающий наличие льготной категории"
            *ngIf="inquiry.privilege?.privilegeProofDocument">
          </app-confirmation-document-card>
        </ng-container>
        <div class="col-md-6" *ngIf="!inquiry.privilege">
          Без льготы
        </div>

      </app-inquiry-info-edit>
    </div>
    <div class="col-md-4">
      <app-inquiry-info-edit title="Файлы" (edit)="edit.fileAttachments()">
        <div class="form-group" *ngFor="let file of inquiry.filesInfo.files">
          {{file.name}}({{file.description}})
        </div>
        <div class="form-group">
          <b>Документы подписаны электронной подписью</b> {{inquiry.filesInfo.haveDigitalSignature ? "Да" : "Нет"}}
        </div>
      </app-inquiry-info-edit>
    </div>
  </div>

</div>