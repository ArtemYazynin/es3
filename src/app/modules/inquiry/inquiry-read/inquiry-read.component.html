<div *ngIf="$inquiry | async as inquiry">
  <ng-template #parentTemplate>
    <app-inquiry-info-edit title="Законный представитель" (edit)="edit.person(applicantTypes.Parent)">
      <div class="row">
        <div class="col-md-6">
          <dl class="dl-horizontal">
            <dt>ФИО</dt>
            <dd>{{drawManager.fio(inquiry.parent)}}</dd>
            <dt>Документ</dt>
            <dd>{{drawManager.identityCard(inquiry.parent.identityCard)}}</dd>
            <dt>СНИЛС</dt>
            <dd>{{inquiry.parent.snils || "-"}}</dd>
            <dt>Гражданство</dt>
            <dd>{{drawManager.citizenships(inquiry.parent.citizenships, countries)}}</dd>
            <div *ngIf="inquiry.parent.countryStateDocument">
              <dt>Документ, подтверждающий право пребывания законного представителя на территории РФ</dt>
              <dd>{{getDocumentView(inquiry.parent.countryStateDocument)}}</dd>
            </div>
            <dt>Родственная связь</dt>
            <dd>{{inquiry.parent.relationType.name}}</dd>
            <div *ngIf="inquiry.parent.relationType.confirmationDocument">
              <dt>Документ, подтверждающий право законного представителя представлять интересы ребенка</dt>
              <dd>{{getDocumentView(inquiry.parent.parentRepresentChildrenDocument)}}</dd>
            </div>
          </dl>
        </div>
      </div>
    </app-inquiry-info-edit>
  </ng-template>
  <div class="col-md-12">
    <div class="{{inquiry.applicant ? 'col-md-12' : 'col-md-6'}}">
      <app-inquiry-info-edit title="Заявление {{inquiry.number}}">
        <div class="row">
          <div class="col-md-6">
            <h4>Заявление в {{inquiry.typeFriendlyName}}</h4>
            <app-inquiry-common-info [inquiry]="inquiry">
              <dt>Заявление на перевод</dt>
              <dd>Нет</dd>
              <div *ngIf="inquiry && inquiry.privilege && inquiry.privilege.privilegeOrder">
                <dt>Льгота</dt>
                <dd>
                  {{inquiry.privilege.privilegeOrder.name}}<br>
                  <i>{{inquiry.privilege.name}}</i>
                </dd>
                <dt>Документ, подтверждающий льготу</dt>
                <dd>{{getDocumentView(inquiry.privilege.privilegeProofDocument)}}</dd>
              </div>
              <dt>Доп. информация</dt>
              <dd>{{inquiry.addInformation}}</dd>
            </app-inquiry-common-info>
          </div>
        </div>
        <div class="button-row" [formGroup]="statusForm">
          <mat-form-field style="width: 70%">
            <mat-select placeholder="Перевести в статус" formControlName="status" #status>
              <mat-option *ngFor="let status of statuses" [value]="status.id">
                {{status.name}}
              </mat-option>
            </mat-select>
          </mat-form-field>
          <button type="button" class="btn btn-primary" (click)="changeStatus(status.value)">Выполнить</button>
        </div>
      </app-inquiry-info-edit>
    </div>
    <div class="col-md-6" *ngIf="!inquiry.applicant">
      <ng-container *ngTemplateOutlet="parentTemplate">
      </ng-container>
    </div>
  </div>
  <div class="col-md-12" *ngIf="inquiry.applicant">
    <div class="col-md-6">
      <app-inquiry-info-edit title="Доверенное лицо законного представителя ребенка" (edit)="edit.person(applicantTypes.Applicant)">
        <div class="row">
          <div class="col-md-6">
            <dl class="dl-horizontal">
              <dt>ФИО</dt>
              <dd>{{drawManager.fio(inquiry.applicant)}}</dd>
              <dt>Документ</dt>
              <dd>{{drawManager.identityCard(inquiry.applicant.identityCard)}}</dd>
              <dt>СНИЛС</dt>
              <dd>{{inquiry.applicant.snils || "-"}}</dd>
              <dt>Гражданство</dt>
              <dd>{{drawManager.citizenships(inquiry.applicant.citizenships, countries)}}</dd>
              <div *ngIf="inquiry.applicant.countryStateApplicantDocument">
                <dt>Документ, подтверждающий право пребывания доверенного лица законного представителя на территории РФ</dt>
                <dd>{{getDocumentView(inquiry.applicant.countryStateApplicantDocument)}}</dd>
              </div>
              <div>
                <dt>Документ, подтверждающий полномочие доверенного лица представлять интересы законного представителя
                  ребенка</dt>
                <dd>{{getDocumentView(inquiry.applicant.applicantRepresentParentDocument)}}</dd>
              </div>
            </dl>
          </div>
        </div>
      </app-inquiry-info-edit>
    </div>
    <div class="col-md-6" *ngIf="inquiry.applicant">
      <ng-container *ngTemplateOutlet="parentTemplate">
      </ng-container>
    </div>
  </div>
  <div class="col-md-12">
    <div class="widget-box">
      <div class="widget-title">
        <h5>Ребёнок (дети)</h5>
        <div class="buttons">
          <a class="btn "><i class="fas fa-redo"></i></a>
          <a class="btn "><i class="fas fa-edit"></i></a>
        </div>
      </div>
      <div class="widget-content">
        <div class="row">
          <div *ngFor="let child of inquiry.children; let last = last;">
            <div class="col-md-6">
              <dl class="dl-horizontal">
                <dt>ФИО</dt>
                <dd>{{drawManager.fio(child)}}</dd>
                <dt>Документ</dt>
                <dd>{{drawManager.identityCard(child.identityCard)}}</dd>
                <dt>СНИЛС</dt>
                <dd>{{child.snils || "-"}}</dd>
                <div class="widget-box" *ngIf="child.specHealthDocument != null || child.specHealthDocument != undefiend">
                  <h5>Документ, подтверждающий потребность в группе с ОВЗ</h5>
                  <div class="widget-content">
                    <dt>Название </dt>
                    <dd>{{child.specHealthDocument.name}}</dd>
                    <dt>Серия </dt>
                    <dd>{{child.specHealthDocument.series}}</dd>
                    <dt>Номер </dt>
                    <dd>{{child.specHealthDocument.number}}</dd>
                    <dt>Дата выдачи </dt>
                    <dd>{{child.specHealthDocument.dateIssue | date: 'dd.MM.yyyy'}}</dd>
                    <dt>Действителен до </dt>
                    <dd>{{child.specHealthDocument.dateExpired | date: 'dd.MM.yyyy'}}</dd>
                  </div>
                </div>
              </dl>
            </div>
          </div>
        </div>
        <div class="row">
          <dl class="dl-horizontal">
            <dt>Пол </dt>
            <dd>{{inquiry.children[0].gender == 1 ? "Мужской":"Женский"}}</dd>
            <dt>Дата рождения </dt>
            <dd>{{inquiry.children[0].birthDate | date: "dd.MM.yyyy"}}</dd>
            <dt>Место рождения </dt>
            <dd>{{inquiry.children[0].birthPlace}}</dd>
            <dt *ngIf="inquiry.children[0].specHealth != 101">Спец. по здоровью: </dt>
            <dd>{{($specHealth | async)?.name}}</dd>
            <dt>Гражданство</dt>
            <dd>{{drawManager.citizenships(inquiry.children[0].citizenships, countries)}}</dd>
            <dt>Адрес регистрации </dt>
            <dd>{{drawManager.address(inquiry.children[0].register)}}</dd>
            <dt>Адрес проживания </dt>
            <dd>{{drawManager.address(inquiry.children[0].residential)}}</dd>
          </dl>
        </div>
      </div>
    </div>
  </div>
  <div class="col-md-12">
    <app-inquiry-info-edit title="Параметры заявления" (edit)="edit.inquiryInfo()">
      <div class="row">
        <div class="col-md-4">
          <app-inquiry-info-edit title="Параметры комплектования">
            <div class="row">
              <dl class="dl-horizontal">
                <dt>Желаемая дата зачисления </dt>
                <dd>{{inquiry.inquiryInfo.distributionParams.wishDate}}</dd>
                <dt>Предпочитаемая специфика группы </dt>
                <dd>{{(specificity | async)?.name}}</dd>
              </dl>
            </div>
            <ul>
              <li *ngIf="inquiry.inquiryInfo.distributionParams.offerGeneralGroup"> Предоставлять общеразвивающую
                группу, если нет мест в группе по нездоровью </li>
              <li *ngIf="inquiry.inquiryInfo.distributionParams.offerCareGroup"> Согласен получить группу по
                присмотру и уходу, если не будет других мест </li>
              <li *ngIf="inquiry.inquiryInfo.distributionParams.isSearchNear"> Предлагать ДОО рядом с
                предпочитаемым </li>
              <li *ngIf="inquiry.inquiryInfo.distributionParams.isCanTempEnrolled"> Предлагать временное зачисление
              </li>
            </ul>
          </app-inquiry-info-edit>
        </div>
        <div class="col-md-4">
          <app-inquiry-info-edit title="Режим пребывания">
            <ul>
              <li *ngIf="inquiry.inquiryInfo.stayMode.IsFullStay"> Полный день (10,5-12 часов) </li>
              <li *ngIf="inquiry.inquiryInfo.stayMode.IsNightStay"> Круглосуточного пребывания (24 часа) </li>
              <li *ngIf="inquiry.inquiryInfo.stayMode.IsShortStay"> Кратковременного пребывания (3-5 часов) </li>
              <li *ngIf="inquiry.inquiryInfo.stayMode.IsReducedStay"> Сокращенного дня (8-10 часов) </li>
              <li *ngIf="inquiry.inquiryInfo.stayMode.IsExtendedStay"> Продленного дня (13-14 часов) </li>
            </ul>
          </app-inquiry-info-edit>
        </div>
        <div class="col-md-4">
          <app-inquiry-info-edit title="Возрастная группа">
            <ul>
              <li *ngIf="inquiry.inquiryInfo.ageGroup.IsSearchYoungerAge"> Младшая возрастная группа </li>
              <li *ngIf="inquiry.inquiryInfo.ageGroup.IsSearchSelfAge"> Своя возрастная группа </li>
              <li *ngIf="inquiry.inquiryInfo.ageGroup.IsSearchOlderAge"> Старшая возрастная группа </li>
            </ul>
          </app-inquiry-info-edit>
        </div>
      </div>
    </app-inquiry-info-edit>
  </div>
  <div class="col-md-12">
    <div class="col-md-4">
      <div class="widget-box">
        <div class="widget-title">
          <h5>Контактная информация</h5>
        </div>
        <div class="widget-content">
          <div class="row">
            <dl class="dl-horizontal">
              <dt>Email </dt>
              <dd>{{inquiry.contactInfo.email || "-"}}</dd>
              <dt>Номер для смс </dt>
              <dd>{{inquiry.contactInfo.smsPhone || "-"}}</dd>
              <dt>Телефон(ы) </dt>
              <dd>{{inquiry.contactInfo.phones || "-"}}</dd>
            </dl>
          </div>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <app-inquiry-info-edit title="Предпочитаемые организации" (edit)="edit.institutions()">
        <div class="form-group" *ngFor="let institution of inquiry.institutions; let i = index">
          {{i+1}}.{{institution.name}}
        </div>
      </app-inquiry-info-edit>
    </div>
    <div class="col-md-4">
      <div class="widget-box">
        <div class="widget-title">
          <h5>Текущее место обучения ребенка</h5>
        </div>
        <div class="widget-content">
          <div [ngSwitch]="inquiry.currentEducationPlace.isOther">
            <div *ngSwitchCase="true">
              <div class="form-group">
                <b>Тип </b> Другая
              </div>
              <div class="form-group">
                <b>Образовательная организация </b> {{inquiry.currentEducationPlace.other}}
              </div>
            </div>
            <div *ngSwitchCase="false">
              <div class="row">
                <dl class="dl-horizontal">
                  <dt>Тип </dt>
                  <dd>{{($institutionType | async)?.name}}</dd>
                  <dt>Образовательная организация </dt>
                  <dd>{{inquiry.currentEducationPlace.institution.name}}</dd>
                  <dt>Група/класс </dt>
                  <dd>{{($group | async)?.name || "-"}}</dd>
                </dl>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="col-md-12">
    <div class="col-md-4">
      <app-inquiry-info-edit title="Льготная категория" (edit)="edit.privilege()">
        <div class="row">
          <dl class="dl-horizontal" *ngIf="inquiry.privilege">
            <dt>Приоритет льготной категории </dt>
            <dd>{{inquiry.privilege.privilegeOrder.name}}</dd>
            <dt>Льготная категория </dt>
            <dd>{{inquiry.privilege.name}}</dd>
          </dl>
          <div class="col-md-6" *ngIf="!inquiry.privilege">
            Без льготы
          </div>
        </div>
        <app-inquiry-info-edit title="Документ, подтверждающий наличие льготной категории" *ngIf="inquiry.privilege?.privilegeProofDocument">
          <div class="row">
            <dl class="dl-horizontal">
              <dt>Название документа </dt>
              <dd>{{inquiry.privilege.privilegeProofDocument.name}}</dd>
              <dt>Серия документа </dt>
              <dd>{{inquiry.privilege.privilegeProofDocument.series || "-"}}</dd>
              <dt>Номер документа </dt>
              <dd>{{inquiry.privilege.privilegeProofDocument.number}}</dd>
              <dt>Дата выдачи </dt>
              <dd>{{inquiry.privilege.privilegeProofDocument.dateIssue | date: 'dd.MM.yyyy'}}</dd>
              <div class="form-group" *ngIf="inquiry.privilege.privilegeProofDocument.dateExpired">
                <dt>Действительно до </dt>
                <dd>{{inquiry.privilege.privilegeProofDocument.dateExpired | date: 'dd.MM.yyyy'}}</dd>
              </div>
            </dl>
          </div>
        </app-inquiry-info-edit>
      </app-inquiry-info-edit>
    </div>
    <div class="col-md-4">
      <div class="widget-box">
        <div class="widget-title">
          <h5>Файлы</h5>
        </div>
        <div class="widget-content">
          <div class="form-group" *ngFor="let file of inquiry.filesInfo.files">
            {{file.name}}({{file.description}})
          </div>
          <div class="form-group">
            <b>Документы подписаны электронной подписью</b> {{inquiry.filesInfo.haveDigitalSignature ? "Да" : "Нет"}}
          </div>
        </div>
      </div>
    </div>
  </div>

</div>